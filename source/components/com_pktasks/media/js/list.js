/**
 * @package      pkg_projectknife
 *
 * @author       Tobias Kuhn (eaxs)
 * @copyright    Copyright (C) 2015 Tobias Kuhn. All rights reserved.
 * @license      GNU General Public License version 2 or later.
 */
PKlistTasks=window.PKlistTasks||{},PKlistTasks.initProgressButton=function(a,b){if("string"==typeof a)var c=jQuery(a);else var c=a;for(var d=c.length,e=null,f=0;f!=d;f++)e=jQuery(c[f]),e.hasClass("disabled")||e.click(function(){if(el=jQuery(this),el.hasClass("disabled"))return!1;var a=parseInt(el.attr("data-id")),c=parseInt(el.attr("data-progress")),d=100==c?0:100;el.addClass("disabled"),jQuery.ajax({url:b,data:"cid[]="+a+"&progress="+d+"&tmpl=component&format=json",type:"GET",processData:!0,cache:!1,dataType:"json",success:function(a){if(!a.success)return Joomla.renderMessages(a.messages),!1;if(el.removeClass("btn-danger"),el.removeClass("btn-warning"),el.removeClass("btn-success"),100==d)el.addClass("btn-success"),el.attr("data-progress","100"),el.text(Joomla.JText._("PKGLOBAL_COMPLETED"));else{el.attr("data-progress","0");var b=parseInt(el.attr("data-due"));if(Date.now)var c=Math.floor(Date.now()/1e3)/86400*86400;else var c=Math.floor((new Date).getTime()/1e3)/86400*86400;b>c||0==b?(el.text(Joomla.JText._("PKGLOBAL_TODO")),el.addClass("btn-warning")):b==c?(el.text(Joomla.JText._("PKGLOBAL_DUE_TODAY")),el.addClass("btn-warning")):(el.text(Joomla.JText._("PKGLOBAL_OVERDUE")),el.addClass("btn-danger"))}el.removeClass("disabled")}})})},PKlistTasks.initProgressSlider=function(a,b){if("string"==typeof a)var c=jQuery(a);else var c=a;for(var d=c.length,e=null,f=0;f!=d;f++)e=jQuery(c[f]),e.hasClass("disabled")?e.slider("disable"):e.slider().on("slideStop",function(a){el=jQuery(this);var c=parseInt(el.attr("data-id")),d=parseInt(el.attr("data-progress")),e=parseInt(a.value);return e!=d&&(el.slider("disable"),void jQuery.ajax({url:b,data:"cid[]="+c+"&progress="+e+"&tmpl=component&format=json",type:"GET",processData:!0,cache:!1,dataType:"json",success:function(a){return a.success?(el.attr("data-progress",e),void el.slider("enable")):(Joomla.renderMessages(a.messages),!1)}}))}).data("slider")},PKlistTasks.initPriorityButton=function(a,b){if("string"==typeof a)var c=jQuery(a);else var c=a;for(var d=c.length,e=null,f=0;f!=d;f++)e=jQuery(c[f]),e.hasClass("disabled")||e.click(function(a){el=jQuery(this);var c=parseInt(el.attr("data-id")),d=parseInt(el.attr("data-value")),e=1==d?0:1;el.addClass("disabled"),jQuery.ajax({url:b,data:"cid[]="+c+"&priority="+e+"&tmpl=component&format=json",type:"GET",processData:!0,cache:!1,dataType:"json",success:function(a){return a.success?(el.attr("data-value",e),1==e?(el.removeClass("prio-0"),el.addClass("prio-1")):(el.removeClass("prio-1"),el.addClass("prio-0")),PKlistTasks.initPriorityAfterUpdate(el,e),void el.removeClass("disabled")):(Joomla.renderMessages(a.messages),!1)}})})},PKlistTasks.initPriorityAfterUpdate=function(a,b){};